<?xml version="1.0" encoding="UTF-8"?>

<project name="Maashaack Nightly Build" default="main">

    <property file="./build.properties" />
    
    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath> 
            <fileset dir="../ant/lib/ant-contrib/" includes="**/*.jar"/>
        </classpath>
    </taskdef>
    
    <taskdef resource="org/tigris/subversion/svnant/svnantlib.xml">
        <classpath>
            <fileset dir="../ant/lib/svn-ant" includes="**/*.jar"/>
        </classpath>
    </taskdef>
    
    <if>
        <available file="user.properties"/>
        <then>
            <property file="./user.properties" />
        </then>
        <else>
            <fail message="Defines the svn-user and svn-pass properties in the user.properties file to continue."/>
        </else>
    </if>
    
    <target name="main" depends="copy-sources,copy-tests" description="Creates the nightly build."/>
    
    <target name="copy-sources">
        <delete dir="${output-sources}" />
        <mkdir  dir="${output-sources}" />
        <copy todir="${output-sources}">
            <fileset dir="${input-sources}" />
        </copy>
        <delete includeemptydirs="true">
            <fileset dir="${output-sources}" includes="**/.svn" defaultexcludes="false"/>
        </delete>
    </target>
    <target name="copy-tests">
        <delete dir="${output-tests}" />
        <mkdir  dir="${output-tests}" />
        <copy todir="${output-tests}">
            <fileset dir="${input-tests}" />
        </copy>
        <delete includeemptydirs="true">
            <fileset dir="${output-tests}" includes="**/.svn" defaultexcludes="false"/>
        </delete>
    </target>

</project>

